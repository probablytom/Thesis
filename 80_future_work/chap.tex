\chapter{Future Work}\label{chap:future_work}

The focus of this thesis is to develop a state-of-the-art aspect-oriented
framework, to produce a suitable experimental environment to demonstrate its
effectiveness, and to use that environment to investigate whether aspect
orientation can be used to augment models with behavioural variance. \inline{is
suitable for simulation purposes? It's about showing that we \emph{can} use
aspect orientation appropriately in simulation environments, and that aspect
orientation can also lead us to realistic and nuanced simulations, too. Go back
through the pdsf and lit review chapters to make this argument properly.}. We
have found that aspect orientation can be used to create realistic and nuanced
simulations, have successfully produced a well-constrained environment to
simulate for testing purposes, and have produced a novel aspect orientation
framework which demonstrates novel and powerful weaving concepts; lots of
opportunities for research outwith this thesis' scope present themselves.

This chapter describes some possibilities for the presented research to be
extended in the future.

\inline{Add a RQ at the end of each research opportunity; this can and should be
a contribution of the thesis, and the RQs would help to sell it as such.}

\subsection{Aspect-Oriented Metaprogramming in real-world Software Engineering}
\label{subsec:aspect_oriented_metaprogramming}

The combination of metaprogramming and aspect-orientation introduces powerful
new possibilities in the realm of aspect-orientation. In traditional
aspect-oriented work, aspects treat their targets as black boxes; this leads to
some limitations, which aspect-oriented metaprogramming is well positioned to
address.

Traditional aspects cannot add their behavioural modifications interspersed
within the work being done by their target. The ``textbook'' use-case for
aspect-orientation is logging: aspects can separate logging from the business
logic they are applied to. However, a programmer in mainstream programming
paradigms may wish to insert logging behaviour \emph{within} their business
logic, rather than \emph{around} it. Aspect-oriented metaprogramming makes this
possible, as the target can have logging logic interspersed through otherwise
decoupled business logic when woven. To achieve this end goal without
``within''-style aspect application would require a refactoring of business
logic to create join points which traditional aspects could apply against; this
breaks the ``obliviousness'' property of the aspect orientated philosophy as
discussed in \cref{chap:lit_review}.


\inline{These were originally written as separate points, but they shouldn't be.
Rework the preceding and following paragraphs so they read like a series of
points as to the opportunities aomp \& \pdsf make available.}\inline{Maybe this
whole thing's just one subsection? Maybe it should live under a single [section]
heading?}

% Another example of this technique's applicability in a variety of real-world
% situations is that traditional aspects cannot make decisions based on reflection
% on specific properties of the code they are being applied to. This could include
% calculations made, data accessed, or computational complexity as examples. A
% concrete example would be the compilation of Python code for efficient
% performance on a GPU (redirected from the CPU)~\cite{dejice2020thesis}, which is
% achieved via a JIT compiler which optimises looping logic for parallel execution
% on a GPU. Similar optimisations could be made through the analysis of common
% codepaths and profiling of expensive parts of those codepaths, and the automated
% optimisation of them. Research projects are also enabled which do not require
% any optimisation heuristics or logic: as \pdsf makes both the target of aspect
% application and the arguments passed to that target visible, it enables
% instrumentation of programs\footnote{In a similar manner to the instrumentation
% of RPGLite mdoels in \cref{subsec:aspects_instrumenting_model}.} to identify ---
% for example --- whether arguments with certain properties cause slowdowns on a
% codebase. In a hypothetical situation where a codebase was extremely performant
% on a dataset except when processing frames of the dataset containing prime
% numbers, isolating data causing worst-case performance and either automatically
% analysing it or presenting it for a researcher's analysis could be a useful
% feature for resource-constrained RSE teams, or as a built-in feature of
% profilers.

% Aspects with metaprogramming directly support reflection, as access to the
% target's AST is provided as a feature of the technique, and allow transformed
% code to be compiled just-in-time, which directly enables research projects such
% as these. A study of the utility of the aspect-oriented metaprogramming approach
% would support the development of these tools and techniques.


\section{Future Work pertaining to Aspect-Oriented
Simulation}\label{sec:future_work_simulations}

This thesis has described novel techniques augmenting models with new features
and behaviours, and does so in an aspect-oriented manner. The potential for
improving simulations and models using aspect orientation has already been
discussed (most notably by \citeauthor{gulyas1999use}~\cite{gulyas1999use} as
discussed in \cref{ao_and_modelling}); however, \pdsf and aspect-oriented
metaprogramming present new opportunities in the field. This section discussed
avenues for future research which \pdsf enables.


\subsection{Augmentation of pre-existing models}\label{future_work_nudge_model_state}

Myriad models exist which have been provided accurate results in past research,
but where unexpected events such as financial collapses, pandemics, or
unpredictable weather events cause one-off shifts in real-world data which
cannot be accounted for. For example, models of world health over time could not
account for the Covid19 pandemic, and models of the world economy could not
incorporate real-world data from the recession caused by responses to the
pandemic, or the 2008 financial crisis. The World3 model is an example of one
which has provided accurate predictions for decades\inline{Find citations for
World3 model}, but could not account for unexpected incidents when constructed.

Models are often initialised with data describing a system's initial state,
which a model computes on to produce predictions. Any output produced could only
represent the impact of a large, unpredictable event within the system as
changes to data or process; changing either for the entire model risks
compromising a model's predictive quality for the timespan prior to an event.
The modification must therefore be represented as a special case within the
model, leading to ancillary code inline with the model's core logic in a similar
manner to the scattered and tangled code discussed in
\cref{lit_review_AOP_explainer}, which aspect orientation was initially designed
to alleviate. It therefore has similar properties to a cross-cutting
concern~\cite{kiczales1997aspect} and may be suitable for factoring out of a
model's logic and into advice.

Intuitively, this research would aim to show that an aspect could ``nudge'' a
system's state in-line with real-world data when exceptional real-world
circumstances affect a model, but cannot elegantly be represented within the
model's logic. A relevant research question for future work to investigate is:

\begin{researchquestion}
Can aspect orientation be used to introduce special cases to real-world systems
to correct a model's predictions in when a system under research is altered by a
freak event?
\end{researchquestion}

lorum \revnote{``Freak event'' might be too informal here but I'm not sure what
to replace it with.} ipsum


\subsection{Aspect Orientation's utility for Research Software Engineers}

As a corollary of the research opportunities for aspect orientation's use in
software engineering discussed in \cref{subsec:aspect_oriented_metaprogramming},
there is an opportunity for research software engineers to also benefit from the
adoption of aspect oriented programming. However, while aspect orientation's use
in industrial software engineering has drawn
criticism~\cite{steimann06paradoxical,przybylek2010wrong,Constantinides04aopconsidered}\footnote{A
review of aspect orientation's critique is presented in
\cref{subsec:aop-criticisms}.} its use within research codebases is a special
case where it may be more suitable, particularly considering the possibilities
discussed through the rest of this chapter.\inline{Revisit this paragraph. Is this too wordy /
rambly / unclear? Can I tighten it up at all?}

The resource constraints and stringent requirements for accuracy in research
codebases present challenges which augmentation through aspects could
assist with. Compensating for a special case in a pre-existing model would
require maintenance of the codebase, which takes time and could inadvertently
alter its behaviour. Time is a scarce resource in research environments, and
undesired changes to a model's behaviour can invalidate research results. An
alternative to adjusting the models directly is to construct aspects which
represent large and unpredictable events in real-world systems such as
pandemics, economic crises, war and famine. These can be modelled on real-world
data for accuracy, which can produce realistic simulations as this thesis
demonstrates. This use of aspect orientation in simulation and modelling can be
investigated by creating a proof-of-concept of the approach as applied to
pre-existing models.\footnote{This approach is similar to \pdsf{}'s initial
proof-of-concept study~\cite{wallis2018caise} as discussed in
\cref{chap:prior_work}.} Studies can also be conducted to investigate whether an
aspectually-augmented model is quicker to construct and easier to maintain in
future than a codebase with ``patches'' written into its original logic.

Researchers investigating this technique's application to existing models could
also investigate the difficulties of augmenting a model created with no
intention of weaving advice in the future. The construction of advice requires
appropriate join points to be specified, and codebases which are structured in a
way which doesn't yield convenient join points might be more complex to augment
aspectually. These cases raise another use-case of \pdsf{}'s ``within''-style
weaving through runtime metaprogramming: where other aspect orientation
frameworks force aspects to treat the targets they are invoked on as
black-boxes, \pdsf can make modifications within them. \pdsf{}'s new kinds of
aspects may therefore be more useful than those in other frameworks for
researchers responsible for maintaining codebases written with no consideration
for join-point specification, and would therefore be more universally
applicable; this possibility requires future investigation.

If the research described successfully shows that aspectually-augmented
simulations are easier and quicker for an RSE to maintain and deliver than
direct maintenance of the model's codebase, then augmentation of existing models
to improve their accuracy can follow in the community. \revnote{If I've got
time, I'd love to push my codebase augmenting a World3 model to achieve just
this with predictive implications for the 2008 financial crisis and the covid
pandemic.}
    
% ==== also wrote the below in another section and realised it's acutally about
% this point. I'd already finished this subsec, but leaving below in case I want
% to use it later.


% Relatedly, model features can be added as extensions through aspect
% orientation with the possibility of lower maintenance cost and increased
% flexibility. By way of illustration, consider researchers investigating a
% car's structural integrity in a collision, and suppose that they can create
% models of physical objects interacting. A scenario might arise where the
% precise mechanics of a car's structural change under impact may be poorly
% understood; many hypotheses may exist as how crumple zones made of a certain
% material absorb an impact and morph under its force. In this scenario, the
% task of the researchers might be to investigate different designs of their car
% to optimise crumple zone performance. Many models could be produced; one for
% each crumple zone. A model could also be constructed with parameterised
% properties of the car, allowing one codebase to consolidate several models.
% However, these parameters are likely to relate to the research at hand; to
% parameterise unnecessary components of the model adds complexity and spends
% development time for no clear gain. Future research projects may investigate
% model components which were not parameterised in the model's initial design.
% This raises a problem: how can the development team work to re-use the model
% while minimising maintenance cost?

% A solution is to add additional parameters as aspects. As aspect orientation
% frameworks supporting within-style changes can make arbitrary changes to the
% codebase, modifications can be made which leave the original model intact, but
% produce an additional model by using aspect orientation as to ``patch'' the
% original. If, in the future, extensions are required for either the original
% model or its extended version, aspects can be added to either. The logical
% conclusion of the design is that all model features could be implemented as
% sets of aspects adding functionality to a simple base model, and a model
% suitable for any piece of work can be constructed by composing relevant model
% components (weaving relevant aspects), extending functionality by adding a new
% behaviour to the set of available models if required. 
    



%% === Explainer for future Tom: I removed the below because it's included in 
%%     \cref{future_work_nudge_model_state}, but left the below here on the
%      offchance I wanted to come back to it when editing. If you don't care,
%      just delete it.
% \subsection{Aspects to Nudge System State}
% \label{future_work_using_aspects_to_correct_simulated_state}
% \revnote{Title too informal? Can't find a good title for this\ldots{}}

% Relatedly, aspects can represent anticipated future states\inline{rework; it's
% not anticipated future states, it's making long-term predictions based on
% small but discrete changes to existing dynamics, which can be quantised as
% aspects.} to model their potential impact without modifying a known-good model
% of the world today. Future health and economic crises can be constructed as
% prospective changes to a model in an aspect, and applied to investigate the
% possible effects. A potential benefit of this approach as opposed to the
% simple modification of an existing model would be that many potential crises
% can be applied in any combination. For example, 10 aspects representing
% unpredictable future events yield 1024 possible combinations: there are
% \(2^{10}\) possible combinations of these aspects being applied or omitted
% from an execution of a simulation. Work to develop aspect-oriented models of
% speculative futures therefore gives an exponential number of predicted
% futures, which one could analyse to predict possible future trends. With a
% successful proof-of-concept of the augmentation of existing models to
% represent past events, this further step could anticipate future events and
% take advantage of aspect orientation's unique properties as a tool for
% simulation and modelling.

%% TODO: start the below describing the _problem_, then move to the pdsf
%        solution



\subsection{Hypothesising Possible System Dynamics via Aspects}

% In the above section we claim that we can augment models to keep them relevant
% in the face of unpredictable events; we can also investigate uncertain present
% properties of systems by modelling them in a naive manner and encoding
% hypothesised behaviour as aspects; we can correlate real-world data to data
% produced by aspectually agumented simulations to discover which hypothesised
% system is most similar to the real world. We can also use this as a benchmark
% to judge improvements made by improved hypotheses in the future.

Unpredictable events can cause discrepancies between simulated system state at a
given time and the real-world system it models, as discussed in
\cref{future_work_using_aspects_to_correct_simulated_state}. While this
technique presents promising research opportunities, researchers face other kind
of model uncertainty which aspect orientation could also counter.

In some scenarios, it is difficult or impossible to make predictions about a
system's future states because its dynamics are actively being researched.
Standard scientific practice is to create a model --- mathematical,
computational, or otherwise --- to create synthetic datasets which indicate
accuracy if their predictions align with what is empirically observed.
\inline{Cite popper, any point including studies that do this too? It's fairly
table stakes as a concept\ldots{}} Some aspects of the system under study may be
well-understood.

Rather than creating models of an existing system which encode its hypothesised
behaviour, a naive model can be created which operates as the scientific
consensus understands it. Hypothesised behaviour takes the form of aspects
altering behaviour in any manner the hypothesis requires. Within-style aspects
allow arbitrary modifications, to simulated behaviour, increasing the
flexibility of the technique. Data produced by each model can be compared to
empirically sourced data, and their similarity quantified, as demonstrated in
\cref{chap:exp1_simulation_optimisation} and
\cref{chap:exp2_old_aspects_new_systems}. Our null hypothesis is that the naive
model's similarity to empirically sourced data is greater than that of the
aspectually augmented model; our experiment's hypothesis is that the behavioural
change applied as aspects is more representative of the system under study than
that of the community consensus.

This technique has a satisfying\revnote{Maybe too informal, but I don't know,
maybe live a little\ldots{}?} property: the hypothesis in a given experiment is
clearly described by its aspectual representation, and if an experiment is
successful --- meaning its hypothesised behaviour accurately represents the
real-world system --- then the model adopted in future research as that of the
community consensus can be the aspectually-augmented one produced by the
original study. In this way, the scientific process is directly represented in
the structure of the codebase, and the community's progression to increasingly
accurate models of a system is represented by the progressive adoption of
``patches'' to an original theory.

Hypotheses can also be created compositionally in this model. Researchers might
develop a series of potential system properties or behaviours, but are unable to
investigate all reasonable combinations in a timely manner. However, sets of
aspects representing each can be composed to produce, for $N$ hypothesised
behaviours, $2^N$ potential behaviours which can be compared to empirical
datasets to identify which combination of possible behaviours most closely
resembles that of the real-world system under study. The technique is similar to
modern pharmacutical development, where a series of algorithmically identified
compounds can be produced and tested to identify which are most suitable to
treat a medical issue\inline{find a citation for modern algorithmic / robotic
drug development}, but can be applied to any models where aspectual augmentation
is appropriate.

\revnote{This subsec is already quite long, and including this point makes it
significantly longer. Maybe that's not a prob; maybe this should be a separate
point / subsubsec; maybe it can live in a footnote; maybe it should be omitted
completely.}This technique for developing experimental model codebases has
another desirable property: it unifies seemingly incompatible philosophies of
the scientific process. \citeauthor{kuhn2012structure}~\cite{kuhn2012structure}
explains the scientific process as inherently social: it starts with a paradigm
which is accepted as broadly true, and accumulates an increasing number of
exceptions until the paradigm itself is deemed unfit, and a new basis for a
field's research is adopted.
\citeauthor{popper1972theoryevolution}~\cite{popper1972theoryevolution} explains
the scientific process as an approximation towards truth, with incremental
progress made with each result achieved by a research community. The proposed
technique for developing experimental model codebases demonstrates features of
both. Consider the original model a paradigm initially selected by community
consensus, and the application of aspects Popper's incremental movements toward
truth (as successful experiments are conducted) or Kuhn's exceptions to the
agreed model (as experiments identify weaknesses in the original model). In this
case, each successive new model adopted by a community is adopted in a
Popplarian manner: improvements are objectively measured, incremental, and would
trend towards truth as a model's behaviour fits empirical observations
increasingly closely. However: over a sufficient period of time, the incremental
patching of an original model would produce an accepted community model which
contains a relatively large amount of discovery and complexity encoded in
aspects, as compared to the original model they are applied to. One would expect
the research community to rewrite the base model to simplify future aspect
application and to more elegantly encode recent research findings; effectively
discarding the original paradigm in favour of a new one. This process is Kuhn's
``paradigm shift'', where paradigms are dropped once a generation of researchers
determine that an originally accepted theory on a topic is unfit for purpose as
evidenced by mounting exceptions in the literature; a new paradigm is to be
accepted by the community, as a new base model would have to be written and
adopted.

The relevant philosophy of science is more nuanced than its brief explanation
here, and the suitability of the approach for the development of research
codebases is to be investigated; the work involved is outwith the scope of this
thesis, but is suggested as future work. A basis for the incremental improvement
of models via aspects is effectively demonstrated in
\cref{chap:exp1_simulation_optimisation} and
\cref{chap:exp2_old_aspects_new_systems}, but the feasibility of the approach as
a basis of a community's scientific process and relation to philosophy of
science warrants further investigation.








% ======= mark: above written, below yet to write.
% ======= 230812







\subsection{Standards for Aspect Orientation in Research
Codebases}
\label{subsec:standard_aosm_techniques}
% The above makes the case that aspects might be shared between different
% research groups' experiments, and also makes the case that models with
% different aspects applied should be comparable. To do that, and to encourage a
% community to blossom, there should be guidelines and/or stnadards around
% developing aspectual model features. 


% How can we make a more ``principled'' approach to adopting features for
% modelling? PDSF's approach to adding things to a model is powerful and
% flexible. A technique that would work for broad applications could allow for a
% standard in the RSE community for simulations, at least for sociotechnical
% simulation. What are the best practices around the modification of scientific
% models in this way, that could encourage collaboration and the sharing of
% models across groups?


The possibility of a research community sharing models containing aspectual
augmentation and possibly developing additional aspects to augment a model
further involves a considerable amount of model logic written within as advice.
The community developing these aspects have the responsibilities of maintaining
a codebase, but the added complexity that research software engineering
introduces. These codebases may be used for many years, and may be iterated in
in a series of future experiments. The legibility of these codebases and their
long-term maintenance are areas of criticism in the software engineering
community~\cite{steimann06paradoxical,przybylek2010wrong,Constantinides04aopconsidered}.
The research community must therefore mitigate these weaknesses of the
aspect-oriented paradigm when adopting the techniques discussed in this chapter
for simulation and modelling.

To address the concern of the visibility of advice being woven, researchers may
already take advantage of\revnote{I've made this an enumerated list; is it
better as a paragraph?}:

\begin{enumerate}
    \item Improvements to tooling produced by the aspect orientation research
    community, including IDE integration~\cite{clement2003eclipseAJDT} and
    runtime inspection~\cite{mehner2002towards}, should make clear to engineers
    what advice is being woven in a codebase and assist with debugging
    aspect-oriented programs respectively.
    \item Aspect-orientation frameworks specifically designed to clarify to an
    engineer the aspects being woven should allow for less friction on the part
    of a maintainer who inherits a codebase and must reason about its behaviour.
    This is particularly important if the maintainer aims to weave more aspects
    into the codebase, and so must understand its existing behaviour before
    augmenting it further. Adopting weaving patterns such as import hook weaving
    --- described in \cref{chap:pdsf_rewrite} --- should make a program clearer
    to a developer regardless of the tooling they have access to.
\end{enumerate}

The impact of framework design on a codebase's maintenance should assist a
developer even in the absence of tooling, but the success of import hook weaving
in this regard is untested. An appropriate research question which arises is
therefore:

\begin{researchquestion}
Do aspect orientation frameworks with weaving techniques designed to simplify a
developer's understanding of a program affect a codebase's long-term
maintainability?
\end{researchquestion}


\subsection{Standard Aspect-Oriented Model
Features}
\label{standard_aosm_model_features}
% The above makes the case for creating standards for model features, motivated
% by the possibility that aspects can be shared between research groups or the
% application of different aspects applied. A step toward creating that standard
% could be to create a fuzzimoss-style library of either fundamental fuzzers,
% tooling to simplify common fuzzing operations, or…??

Researchers who build aspect-oriented models and extend others' aspect-oriented
codebases must be able to collaborate at least as easily as they currently do in
a culture without aspect orientation. One way aspect orientation might improve
researchers' ease of collaboration is with standardised libraries for aspect
construction. Similar libraries were developed when developing a case study for
\pdsf{}'s viability~\cite{wallis2018caise,fuzzimoss_repo}, but development was
left incomplete as discussed in \cref{subsec:prior_work_fm}.

The original library with this aim, Fuzzi-Moss, was originally designed to
provide standardised aspects to represent behavioural variance in
\sociotechnical systems. The aspects developed in Fuzzi-Moss have no notion of
being fitted to real-world data. Instead, they are simple models of behavioural
variances such as distraction, which are parameterised to allow users of the
library to use these simple models in whatever manner is appropriate for their
use-case. A broader collection of these behavioural variations could simplify
the use of aspect-oriented behavioural variation in the research community writ
large, by removing researchers' burden to develop these themselves. Early
construction of a library with Fuzzi-Moss' goals would also support researchers
in sharing models or extending others', as they would be familiar with a common
set of tools. The development of such a library and the production of case
studies demonstrating its effectiveness would answer the research question:

\begin{researchquestion}
    Can researchers using aspect-oriented behavioural variance share a common
    set of tools to support and simplify the use of the technique in their
    codebases?
\end{researchquestion}

Other tooling to support researchers in the development of aspectually augmented
simulations and models could also be developed. For example, a library of
fuzzers which make changes to an abstract syntax tree could be constructed. Such
a library would not model specific behaviours, but would allow researchers to
build models performing within-style aspect weaving without writing code which
contained no metaprogramming logic. Instead, this logic would be encapsulated in
utility functions provided by the proposed library. This would also reduce the
work required of researchers looking to use the techniques demonstrated in this
thesis. The library could also support the development of a Fuzzi-Moss-like set
of \sociotechnical behavioural variances. However, such a library does not
currently exist. A summary the contribution to the research community which the
proposed library would make is:

\begin{researchquestion}
    The development of a library of metaprogramming operations which simplify
    the construction of within-style aspects, supporting its research use and
    demonstrated in case studies.
\end{researchquestion}

The proposed library need not be a separate codebase to the aspect orientation
framework it is designed alongside. \pdsf{} could contain this collection of
metaprogramming operations; however, there is no obvious\revnote{``obvious'' is
a little too informal, not sure what to replace it with here.} requirement for
the library to be contained within \pdsf{}, and separating the proposed library
from the framework it is built to interact with removes any dependancy on a
particular aspect orientation framework; future researchers could develop
alternative frameworks with within-style aspects which the proposed library
could also be compatible with. We therefore suggest that the development of this
library is a separate project from the development of \pdsf{}
itself.\revnote{This might be a little rambly --- consider omitting, rewording,
or factoring into a footnote.}



\subsection{Testing Frameworks to detect Unrealistic Behavioural
Variances}\label{sciunits_for_unrealistic_states}

Many of the uses of aspect orientation in simulation \& modelling research
discussed in this chapter affect the construction and maintenance of a codebase,
aspect orientation also has potential in the instrumentation of an
experiment, as discussed in \cref{ao_and_modelling}.\footnote{In particular,  
see relevant notes on \citetitle{gulyas1999use}~\cite{gulyas1999use}.}
Experimental instrumentation was demonstrated for data collection in this
thesis' experiments, as discussed in \cref{chap:exp1_simulation_optimisation}
and \cref{chap:exp2_old_aspects_new_systems}.\inline{We can get more precise
than chapter references; find the sections / subsections.} Instrumentation also
has potential in other aspects of research software engineering; one possibility
to be investigated is the use of aspects to alert researchers to impossible
states visited by a model during runtime.

Many models construct a version of a real-world system which cannot achieve
certain states. For example, a model of collisions might never be expected to
see an increase in the total energy present across all modelled entities;
simulations of \sociotechnical systems might expect bounds on the hours worked
by a simulated workforce, or the amount of output the workforce creates;
researchers might study a system to observe a n emergent property which is
bounded by laws around its growth (for example, a linear increase in some
property over time as opposed to exponential growth). It is important that any
model of a real-world system accurately reflects the system's physical limits
and underlying mechanics. Models may fail to reflect these mechanics for many
reasons, including\revnote{Are there any other reasons as to why models might be
incorrect (and instrumentation could identify this by boundary checking)?}:

\begin{itemize}
    \item The model may be developed with bugs which are not detected, i.e. it is
    conceptually incorrect;
    \item The model may be verified as correct but later maintenance introduces
    undetected errors, i.e. it contains bugs;
    \item The model may be correctly written, but given unexpected inputs.
\end{itemize}

Software engineering practices such as unit testing are common practice and may
catch these bugs through identifying incorrect behaviour in components.
Thorough test suites may also include integration tests which observe the
behaviour of many model components working together. However, there are
limitations of both testing techniques:

\begin{itemize}
    \item Test suites as described may fail to identify non-deterministic errors
    in a model, which arise only in a small number of cases;
    \item Traditional test suites also may fail to identify emergent state
    errors, where individual components operate correctly but their repeated
    integration results in an incorrect emergent property of the system
    \footnote{Emergent properties are often the state under study, as in \pdsf's original
    case study~\cite{wallis2018caise}};
    \item Test suites usually fix values such as random seeds or input data,
    which may hide non-deterministic state errors or may not exhibit the
    properties of real-world data (and so exhibit different behaviour under test
    than when an experiment is conducted).
\end{itemize}

We propose the use of aspects to instrument models to assert a system state
within expected bounds, both as components of a test suite and as assurance that
a model was correct at any time it is used as part of an experiment. All of
these limitations can be alleviated by a test suite which is able assert the
correctness of model state at different points in a program's execution. Models
which non-deterministically reach erroneous states are primarily an issue during
the execution of a model; aspectual state assertions need not alter a model's
program flow, so are appropriate for use during its experimental use should any
unexpected state arise. These states may also be deterministically caused by
experimental input data which is not reflected by the inputs in a test suite;
weaving these aspects during experimental use also addresses this limitation.
Emergent properties of a system may also be tracked over time, and aspects may
measure emergent properties to ensure they are within appropriate bounds at all
times in an experiment and have correct properties of their own (for example,
these aspects could ensure correct growth curves for the property in question).

Aspects can also be used as a regression test to detect the recurrence of bugs
after they have been identified and fixed. If a simulated system enters an
incorrect state during development, and the underlying bug is fixed, an aspect
observing the system's erroneous property can be constructed which alerts
developers if the bug is re-introduced.

Aspects instrumenting a model throughout its use in an experiment would also
serve to guarantee peer reviewers of a study that the model was correct
regarding the properties observed by the aspects. A suite of aspects which
observe bounds on and characteristics of system properties is, functionally
speaking, a declarative set of known-good behaviours of a model. Peer reviewers
who sought to check that a model was correct should be able to extend this list
of properties and observe any assertions during reproduction of a study's
findings.

Within-style aspects are particularly appropriate for this task, as the
measurement desired of a program might exist inside an existing function or
block of code. It is conceivable that observing system state before and after a
function executes would not be sufficiently granular to assert correct system
state in some cases. Aspectual instrumentation of research codebases is
therefore particularly useful in light of new weaving techniques in \pdsf,
traditional aspect orientation frameworks would be sufficient in instrumenting
at least some models for observation.

To demonstrate the efficacy of this approach, a library of tools to observe
boundaries on system states could be developed, similarly to the library of
tools suggested in \cref{standard_aosm_model_features}. Case studies augmenting
research codebases using either this observational tooling or ordinary aspects
can then be constructed. These should include new codebases, to demonstrate the
technique's utility during development, but should also include the
instrumentation of old models and the detection of any irregularities in
existing, published work. Such a project would answer the research question:

\begin{researchquestion}
    Can aspect orientation be used to instrument a model and assert correctness
    by observing that the model's properties remain within expected bounds?
\end{researchquestion}



\subsection{Optimisation of Multiple
Aspects}\label{many_aspectual_models_to_optimise}

Experiments in \cref{chap:exp1_simulation_optimisation} and
\cref{chap:exp2_old_aspects_new_systems} made use of models which were fitted to
real-world data. However, they only fitted parameters of learning models, and
only some parameters were fitted. This was partly due to the
computational cost involved in fitting these parameters and time constraints on
this research.\revnote{Is this point worthwhile? I cited it in IIRC an
experimental chapter, but I'm unsure it's worth including. For future Tom to revisit.}

Optimisation is an independent research field with a broad range
of techniques outwith the scope of this thesis to explore; however, a study of
optimisation algorithms and technologies as applied to the fitting of aspects to
real-world system models is a topic for future research. Models of real-world
systems can be computationally expensive to complete, meaning that measuring the
accuracy of a model with a variety of parameters could be computationally
expensive. A survey of optimisation techniques suitable for aspectually
augmented simulations and models would answer the research question:

\begin{researchquestion}
    Which optimisation techniques are best suited to fitting parameters of
    aspects woven into models of real-world systems, with regards the
    accuracy of the aspectually augmented model produced?
\end{researchquestion}



\section{Future Work pertaining to RPGLite}\label{sec:future_work_rpglite}
RPGLite's dataset was analysed for the purposes it was collected for in this
thesis: to aid in the realistic simulation of a well-controlled \sociotechnical
system. However, many analyses are yet to be explored:

\subsection{Causes of Game Abandonment}
Why were games abandoned? Are there patterns that can be identified which lead
players to abandon games?
    
\subsection{Patterns of Play within Cliques of Players}
Players likely formed cliques, where they would play against people they knew
(perhaps in person) rather than relying on RPGLite's matchmaking features to
find new opponents. The existence of cliques of players may have implications
for the playstyles of players, how they learned ``better'' strategies over time,
and the players' general dedication to playing RPGLite (and therefore producing
a greater wealth of data for analysis and dissemination to the community)
    
\subsection{Additional Game Features Driving Engagement}
RPGLite's dataset contains information about players' interactions with the
application itself; as the game made available some features typical of modern
games (leaderboards, matchmaking, achievements, graphical customisation), an
analysis of the features most commonly used can shed light on the more effective
aspects of modern game design in both the general playerbase and more dedicated
players\footnote{For example, are some features heavily used, but only by a
dedicated subset? Do all players use other features a moderate amount, showing
mild but general appeal?}\footnote{Find related research on engagement in mobile
games, which must be \emph{plentiful}.}.
    

\subsection{Larger-scale Data Collection}
RPGLite's playerbase was recruited informally and there is scope for a larger
and longer-term data collection effort to be made. A re-release of the
application in major mobile app stores with a concerted effort to release new
seasons of the game and maintain player interest for an extended period of time
--- perhaps with additional features, such as in-game chat, favourites lists
--of previous opponents, or match replay and analysis (with suggestions for
improved play backed by the formal methods inherant in RPGLite's design) would
enable a richer analysis, and broader utility to the games research community.

While investigations into these questions warrant further study, they remain
outwith the scope of this thesis, which focuses on simulation technologies more
than it does game design. There are many opportunities available for the game
design research community to investigate. Publications in the field from
co-creators of RPGLite reflect further on the design and future improvements of
the game; see \inline{cite William's PhD here}.


\section{Discussion}\label{sec:future_work_conclusion}

This section is not intentionally left blank.

